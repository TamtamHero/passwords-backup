(this["webpackJsonppasswords-companion"]=this["webpackJsonppasswords-companion"]||[]).push([[0],{17:function(t,e,n){"use strict";(function(t){n.d(e,"a",(function(){return u})),n.d(e,"b",(function(){return l}));var r=n(1),a=n.n(r),s=n(2),c=n(7),o=n(8),i=n(20),u=(n(15),5),l=6,h=function(){function e(){var n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:4096;Object(c.a)(this,e),this.allowedStatuses=[36864,27013,27270,27271,27904,28160,45056],this.connected=!1,this.metadatas_size_on_device=n,this.metadatas=new t.alloc(n),this.busy=!1}return Object(o.a)(e,[{key:"connect",value:function(){var t=Object(s.a)(a.a.mark((function t(){var e;return a.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(this.connected){t.next=22;break}return t.next=3,i.a.create();case 3:return this.transport=t.sent,t.prev=4,t.next=7,this.getVersion();case 7:return this.version=t.sent,t.next=10,this.getAppName();case 10:if("Passwords"===(e=t.sent).toString()){t.next=13;break}throw new Error(e);case 13:this.connected=!0,t.next=22;break;case 16:return t.prev=16,t.t0=t.catch(4),t.next=20,this.transport.close();case 20:throw this.disconnect(),t.t0;case 22:case"end":return t.stop()}}),t,this,[[4,16]])})));return function(){return t.apply(this,arguments)}}()},{key:"isSuccess",value:function(t){return t.length>=2&&36864===t.readUInt16BE(t.length-2)}},{key:"disconnect",value:function(){this.connected=!1}},{key:"mapProtocolError",value:function(t){if(t.length<2)throw new Error("Response length is too small");var e={27013:"Action cancelled",27270:"SW_WRONG_P1P2",27271:"SW_WRONG_DATA_LENGTH",27904:"SW_INS_NOT_SUPPORTED",28160:"SW_CLA_NOT_SUPPORTED",45056:"SW_APPNAME_TOO_LONG"},n=t.readUInt16BE(t.length-2);if(n in e)throw new Error(e[n])}},{key:"dispatchRequest",value:function(){var t=Object(s.a)(a.a.mark((function t(e,n){var r;return a.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(!this.busy){t.next=2;break}throw new Error("Device is busy");case 2:this.busy=!0,t.prev=3,t.t0=e,t.next=3===t.t0?7:4===t.t0?11:t.t0===u?15:t.t0===l?19:23;break;case 7:return t.next=9,this.getVersion();case 9:return r=t.sent,t.abrupt("break",24);case 11:return t.next=13,this.getAppName();case 13:return r=t.sent,t.abrupt("break",24);case 15:return t.next=17,this.dump_metadatas();case 17:return r=t.sent,t.abrupt("break",24);case 19:return this._toBytes(n),t.next=22,this.load_metadatas();case 22:return t.abrupt("break",24);case 23:throw new Error("Unknown instruction");case 24:return t.prev=24,this.busy=!1,t.finish(24);case 27:return t.abrupt("return",r);case 28:case"end":return t.stop()}}),t,this,[[3,,24,27]])})));return function(e,n){return t.apply(this,arguments)}}()},{key:"getVersion",value:function(){var e=Object(s.a)(a.a.mark((function e(){var n;return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.transport.send(224,3,0,0,t(0),this.allowedStatuses);case 2:return n=e.sent,this.isSuccess(n)||this.mapProtocolError(n),e.abrupt("return",n.slice(0,n.length-2));case 5:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"getAppName",value:function(){var e=Object(s.a)(a.a.mark((function e(){var n;return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.transport.send(224,4,0,0,t(0),this.allowedStatuses);case 2:return n=e.sent,this.isSuccess(n)||this.mapProtocolError(n),e.abrupt("return",n.slice(0,n.length-2));case 5:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"_toBytes",value:function(t){var e=this.metadatas,n=JSON.parse(t).parsed,r=0;n.forEach((function(t){var n=t.nickname,a=t.charsets;if(n.length>19)throw new Error("Nickname too long (19 max): ".concat(n," has length ").concat(n.length));e[r++]=n.length+1,e[r++]=0,e[r++]=a,e.write(n,r),r+=n.length}))}},{key:"_toJSON",value:function(){for(var t=this.metadatas,e=[],n=[],r=0,a=[];;){var s=t[r];if(0===s)break;var c=255===t[r+1],o=t[r+2];s>20&&(a+=[r,"nickname too long ".concat(s,", max is 19")]),c?n.push({nickname:t.slice(r+3,r+2+s).toString(),charsets:o}):e.push({nickname:t.slice(r+3,r+2+s).toString(),charsets:o}),r+=s+2}return{parsed:e,nicknames_erased_but_still_stored:n,corruptions_encountered:a,raw_metadatas:t.toString("hex")}}},{key:"_load_metadatas_chunk",value:function(){var e=Object(s.a)(a.a.mark((function e(n,r){var s;return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.transport.send(224,l,r?255:0,0,t.from(n),this.allowedStatuses);case 2:return s=e.sent,this.isSuccess(s)||this.mapProtocolError(s),e.abrupt("return",s);case 5:case"end":return e.stop()}}),e,this)})));return function(t,n){return e.apply(this,arguments)}}()},{key:"dump_metadatas",value:function(){var e=Object(s.a)(a.a.mark((function e(){var n;return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:this.metadatas=t.alloc(0);case 1:if(!(this.metadatas.length<this.metadatas_size_on_device)){e.next=11;break}return e.next=4,this.transport.send(224,u,0,0,t(0),this.allowedStatuses);case 4:if(n=e.sent,this.isSuccess(n)||this.mapProtocolError(n),this.metadatas=t.concat([this.metadatas,t.from(n.slice(1,-2))]),!(255===n[0]&&this.metadatas.length<this.metadatas_size_on_device)){e.next=9;break}throw new Error("".concat(this.metadatas_size_on_device," bytes requested but only ").concat(this.metadatas.length," bytes available"));case 9:e.next=1;break;case 11:return e.abrupt("return",this._toJSON());case 12:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"load_metadatas",value:function(){var t=Object(s.a)(a.a.mark((function t(){var e,n;return a.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(0!==this.metadatas.length){t.next=2;break}throw new Error("No data to load");case 2:e=0;case 3:if(!(e<this.metadatas.length)){t.next=10;break}return n=this.metadatas.slice(e,e+255),t.next=7,this._load_metadatas_chunk(n,e+n.length===this.metadatas.length);case 7:e+=255,t.next=3;break;case 10:case"end":return t.stop()}}),t,this)})));return function(){return t.apply(this,arguments)}}()}]),e}();e.c=h}).call(this,n(13).Buffer)},32:function(t,e,n){},34:function(t,e,n){},35:function(t,e,n){},41:function(t,e,n){},44:function(t,e,n){"use strict";n.r(e);var r=n(4),a=n(0),s=n.n(a),c=n(5),o=n.n(c),i=(n(32),n(1)),u=n.n(i),l=n(2),h=n.p+"static/media/logo.468afbe1.svg",d=n(11);n(34);var p=function(t){var e=t.text,n=t.color,s=t.onClick,c=Object(a.useState)(!1),o=Object(d.a)(c,2),i=o[0],u=o[1],l=Object(a.useState)(),h=Object(d.a)(l,2),p=h[0],f=h[1],b=Object(a.useRef)(null);Object(a.useEffect)((function(){i&&s(p).then((function(){u(!1)}))}),[i,p,s]);var v=Object(a.useCallback)((function(){b.current&&b.current.click()}),[]),m=Object(a.useCallback)((function(t){t.target.files[0].text().then((function(e){t.target.value="",f(e),u(!0)}))}),[]);return Object(r.jsxs)("button",{className:"LoadButton",disabled:i,onClick:i?null:v,style:{margin:"10px",backgroundColor:n},children:[i?"Loading\u2026":e,Object(r.jsx)("input",{id:"selectedFile_".concat(e),type:"file",ref:b,onChange:m,accept:".json",style:{display:"none"}})]})};n(35);var f=function(t){var e=t.text,n=t.color,s=t.onClick,c=Object(a.useState)(!1),o=Object(d.a)(c,2),i=o[0],u=o[1];return Object(a.useEffect)((function(){i&&s().then((function(t){console.log(t),t&&function(t){var e=new Blob([JSON.stringify(t,null,4)],{type:"application/json;charset=utf-8"}),n=URL.createObjectURL(e),r=document.createElement("a");r.href=n,r.download="backup.json",document.body.appendChild(r),r.click(),document.body.removeChild(r)}(t),u(!1)}))}),[i,s]),Object(r.jsx)("button",{className:"DownloadButton",disabled:i,onClick:i?null:function(){u(!0)},style:{margin:"10px",backgroundColor:n},children:i?"Loading\u2026":e})},b=n(17),v=n(6);n(40),n(41);function m(t,e){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};return new Promise(function(){var r=Object(l.a)(u.a.mark((function r(a){var s;return u.a.wrap((function(r){for(;;)switch(r.prev=r.next){case 0:if(s=null,r.prev=1,t.connected){r.next=5;break}return r.next=5,t.connect();case 5:return v.b.info("Approve action on your device \u2728",{autoClose:!1}),r.next=8,t.dispatchRequest(e,n);case 8:s=r.sent,v.b.dismiss(),v.b.success("Success \u2705"),r.next=18;break;case 13:r.prev=13,r.t0=r.catch(1),t.disconnect(),v.b.dismiss(),v.b.error("".concat(r.t0.toString()," \ud83d\ude45"));case 18:return r.prev=18,a(s),r.finish(18);case 21:case"end":return r.stop()}}),r,null,[[1,13,18,21]])})));return function(t){return r.apply(this,arguments)}}())}var k=function(){var t=new b.c;return Object(r.jsxs)("div",{className:"App",children:[Object(r.jsx)(v.a,{hideProgressBar:!0}),Object(r.jsxs)("header",{className:"App-header",children:[Object(r.jsx)("img",{src:h,className:"App-logo",alt:"logo"}),Object(r.jsxs)("div",{className:"Commands",children:[Object(r.jsx)(f,{text:"Backup",color:"#41ccb4",onClick:function(){return m(t,b.a)}}),Object(r.jsx)(p,{text:"Restore",color:"#FFB86D",onClick:function(e){return m(t,b.b,e)}})]}),Object(r.jsx)("p",{children:"Here is a little blob to explain how to use this website to backup and restore you password app."})]})]})},x=function(t){t&&t instanceof Function&&n.e(3).then(n.bind(null,47)).then((function(e){var n=e.getCLS,r=e.getFID,a=e.getFCP,s=e.getLCP,c=e.getTTFB;n(t),r(t),a(t),s(t),c(t)}))};o.a.render(Object(r.jsx)(s.a.StrictMode,{children:Object(r.jsx)(k,{})}),document.getElementById("root")),x()}},[[44,1,2]]]);
//# sourceMappingURL=main.075d1fc7.chunk.js.map